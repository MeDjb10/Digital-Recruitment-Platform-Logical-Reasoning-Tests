<div class="flex justify-center items-center min-h-screen bg-gradient-to-tr from-blue-700 to-teal-500 px-4 sm:px-6 py-8">
    <!-- Back button - hidden on mobile -->
    <button routerLink="/auth/login"
        class="absolute top-4 left-4 text-2xl text-blue-500 transition-all duration-300 ease-in-out transform hover:translate-x-2 group bg-white min-h-10 min-w-10 rounded-full hidden md:flex items-center justify-center">
        <i class="fa-solid fa-chevron-left transition-transform duration-300 group-hover:scale-110"></i>
        <span class="absolute left-6 top-1/2 -translate-y-1/2 bg-white text-gray-800 px-3 py-1 rounded-r-full text-sm 
            opacity-0 scale-95 group-hover:opacity-100 group-hover:scale-100 
            transition-all duration-300 ease-in-out 
            origin-left transform whitespace-nowrap min-h-10 min-w-10 flex items-center">
            Back to Login
        </span>
    </button>

    <!-- Mobile back button -->
    <button routerLink="/auth/login" 
        class="absolute top-4 left-4 text-white md:hidden flex items-center space-x-2">
        <i class="fa-solid fa-chevron-left"></i>
        <span class="text-sm">Back</span>
    </button>

    <div class="w-full max-w-[320px] sm:max-w-[400px] md:max-w-[480px] lg:max-w-fit p-4 sm:p-6 bg-white rounded-lg shadow-lg">
        <p class="text-xl sm:text-2xl font-bold text-center mb-4 sm:mb-6 text-gray-800">Reset Password</p>

        <mat-stepper linear #stepper class="bg-white w-full">
            <!-- Email Step -->
            <mat-step [stepControl]="emailFormGroup">
                <form [formGroup]="emailFormGroup" class="w-full space-y-4">
                    <ng-template matStepLabel>Email Address</ng-template>
                    <div class="flex flex-col space-y-2">
                        <label for="email" class="text-gray-700 font-medium mb-1">Email</label>
                        <div class="relative"
                            [ngClass]="{'animate-shake': emailFormGroup.get('email')?.invalid && emailFormGroup.get('email')?.touched}">
                            <span class="absolute inset-y-0 left-2 flex items-center text-gray-500">
                                <i class="fa-regular fa-envelope"></i>
                            </span>
                            <input type="email" formControlName="email" id="email"
                                class="border border-blue-300 hover:border-blue-700 hover:shadow-xs focus:shadow-lg p-2 pl-8 rounded-lg ease-in-out transition-colors duration-150 w-full"
                                placeholder="your.email@example.com">
                        </div>
                        <p *ngIf="emailFormGroup.get('email')?.hasError('required') && emailFormGroup.get('email')?.touched"
                            class="text-red-500 text-sm mt-2">
                            <i class="fa-solid fa-triangle-exclamation"></i> Email is required
                        </p>
                        <p *ngIf="emailFormGroup.get('email')?.hasError('email')" class="text-yellow-500 text-sm mt-2">
                            <i class="fa-solid fa-circle-exclamation"></i> Please enter a valid email address
                        </p>
                    </div>
                    <div class="flex justify-end">
                        <button mat-flat-button color="primary" matStepperNext 
                            class="w-full sm:w-auto">
                            Next <i class="fa-solid fa-chevron-right ml-2"></i>
                        </button>
                    </div>
                </form>
            </mat-step>

            <!-- Verification Code Step -->
            <mat-step [stepControl]="codeFormGroup">
                <form [formGroup]="codeFormGroup" class="w-full space-y-4">
                    <ng-template matStepLabel>Verification Code</ng-template>
                    <div class="flex flex-col">
                        <label for="code" class="text-gray-700 font-medium mb-1">Verification Code</label>
                        <div class="relative"
                            [ngClass]="{'animate-shake': codeFormGroup.get('code')?.invalid && codeFormGroup.get('code')?.touched}">
                            <span class="absolute inset-y-0 left-2 flex items-center text-gray-500">
                                <i class="fa-solid fa-key"></i>
                            </span>
                            <input type="text" formControlName="code" id="code"
                                class="border border-blue-300 hover:border-blue-700 hover:shadow-xs focus:shadow-lg p-2 pl-8 rounded-lg ease-in-out transition-colors duration-150 w-full"
                                placeholder="Enter verification code">
                        </div>
                        <p *ngIf="codeFormGroup.get('code')?.hasError('required') && codeFormGroup.get('code')?.touched"
                            class="text-red-500 text-sm mt-2">
                            <i class="fa-solid fa-triangle-exclamation"></i> Verification code is required
                        </p>
                    </div>
                    <div class="flex flex-col sm:flex-row justify-between items-center space-y-2 sm:space-y-0 sm:space-x-4">
                        <button mat-button matStepperPrevious 
                            class="w-full sm:w-auto">
                            <i class="fa-solid fa-chevron-left mr-2"></i> Back
                        </button>
                        <button mat-flat-button color="primary" matStepperNext
                            class="w-full sm:w-auto">
                            Next <i class="fa-solid fa-chevron-right ml-2"></i>
                        </button>
                    </div>
                </form>
            </mat-step>

            <!-- New Password Step -->
            <mat-step [stepControl]="passwordFormGroup">
                <form [formGroup]="passwordFormGroup" class="w-full space-y-4">
                    <ng-template matStepLabel>New Password</ng-template>
                    <div class="flex flex-col mb-4">
                        <label for="password" class="text-gray-700 font-medium mb-1">New Password</label>
                        <div class="relative"
                            [ngClass]="{'animate-shake': passwordFormGroup.get('password')?.invalid && passwordFormGroup.get('password')?.touched}">
                            <span class="absolute inset-y-0 left-2 flex items-center text-gray-500">
                                <i class="fa-solid fa-lock"></i>
                            </span>
                            <input [type]="hidePassword ? 'password' : 'text'" formControlName="password" id="password"
                                class="border border-blue-300 hover:border-blue-700 hover:shadow-xs focus:shadow-lg p-2 pl-8 pr-10 rounded-lg ease-in-out transition-colors duration-150 w-full"
                                placeholder="Enter new password">
                            <button type="button" class="absolute inset-y-0 right-2 flex items-center"
                                (click)="hidePassword = !hidePassword">
                                <i [class]="hidePassword ? 'fa-solid fa-eye-slash' : 'fa-solid fa-eye'"></i>
                            </button>
                        </div>
                        <p *ngIf="passwordFormGroup.get('password')?.hasError('required') && passwordFormGroup.get('password')?.touched"
                            class="text-red-500 text-sm mt-2">
                            <i class="fa-solid fa-triangle-exclamation"></i> Password is required
                        </p>
                    </div>

                    <div class="flex flex-col">
                        <label for="confirmPassword" class="text-gray-700 font-medium mb-1">Confirm Password</label>
                        <div class="relative"
                            [ngClass]="{'animate-shake': passwordFormGroup.get('confirmPassword')?.invalid && passwordFormGroup.get('confirmPassword')?.touched}">
                            <span class="absolute inset-y-0 left-2 flex items-center text-gray-500">
                                <i class="fa-solid fa-lock"></i>
                            </span>
                            <input [type]="hideConfirmPassword ? 'password' : 'text'" formControlName="confirmPassword"
                                id="confirmPassword"
                                class="border border-blue-300 hover:border-blue-700 hover:shadow-xs focus:shadow-lg p-2 pl-8 pr-10 rounded-lg ease-in-out transition-colors duration-150 w-full"
                                placeholder="Confirm new password">
                            <button type="button" class="absolute inset-y-0 right-2 flex items-center"
                                (click)="hideConfirmPassword = !hideConfirmPassword">
                                <i [class]="hideConfirmPassword ? 'fa-solid fa-eye-slash' : 'fa-solid fa-eye'"></i>
                            </button>
                        </div>
                        <p *ngIf="passwordFormGroup.get('confirmPassword')?.hasError('required') && passwordFormGroup.get('confirmPassword')?.touched"
                            class="text-red-500 text-sm mt-2">
                            <i class="fa-solid fa-triangle-exclamation"></i> Confirm password is required
                        </p>
                        <p *ngIf="passwordFormGroup.hasError('passwordMismatch')" class="text-yellow-500 text-sm mt-2">
                            <i class="fa-solid fa-circle-exclamation"></i> Passwords don't match
                        </p>
                    </div>

                    <div class="flex flex-col sm:flex-row justify-between items-center space-y-2 sm:space-y-0 sm:space-x-4">
                        <button mat-button matStepperPrevious
                            class="w-full sm:w-auto">
                            <i class="fa-solid fa-chevron-left mr-2"></i> Back
                        </button>
                        <button mat-flat-button color="primary" (click)="resetPassword()"
                            class="w-full sm:w-auto">
                            Reset Password
                        </button>
                    </div>
                </form>
            </mat-step>
        </mat-stepper>
    </div>
</div>